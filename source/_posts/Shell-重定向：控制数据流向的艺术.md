---
title: Shell 重定向：控制数据流向的艺术
author: Alex
top: false
hide: false
cover: false
toc: true
mathjax: false
categories: Shell
tags:
  - Shell
  - Linux
abbrlink: 8af44f1b
date: 2024-06-20 22:45:59
img:
coverImg:
password:
summary:
---

在 Unix 或 Linux 系统中，我们通常会使用 Shell 来与操作系统交互。在这个过程中，数据的输入和输出是两个非常基础且重要的操作。

理解和掌握输入输出重定向是提高 Shell 使用效率的关键。本文旨在用简单易懂的语言，为你揭开 Shell 重定向的神秘面纱。

## 标准的输入与输出

在 Shell 中，默认情况下，程序的输入来源于键盘，输出则显示在屏幕上。这种默认的行为对我们日常的使用来说是非常方便的。但有时候，我们需要更灵活地控制数据的流向，这时候就需要用到输入输出重定向的技术了。

## 输入输出重定向简介

### 输入重定向

输入重定向允许我们将程序的输入从键盘改为来自于文件或其他数据源。这意味着程序会从我们指定的文件中读取输入，而不是等待我们通过键盘输入。

### 输出重定向

与输入重定向相反，输出重定向让我们可以将程序的输出发送到除了终端显示器外的其他位置，比如文件中。这在我们需要保存输出结果以供后续处理时非常有用。

## 与输入输出有关的文件描述符

在深入理解输入输出重定向之前，我们需要先明白文件描述符的概念。文件描述符是一个数字，它代表着一个打开文件的引用。在 Shell 中，有三个基本的文件描述符：

- **0** - 标准输入（`stdin`），默认从键盘读取
- **1** - 标准输出（`stdout`），默认输出到显示器
- **2** - 标准错误输出（`stderr`），默认也是输出到显示器

了解这三个文件描述符对于理解接下来的内容至关重要。

## 输出重定向

输出重定向允许我们将命令的输出结果从标准输出（通常是屏幕）重定向到文件中。这对于保存命令的执行结果非常有用。

### Bash 支持的输出重定向符号

#### 标准输出重定向

- `>` 用于将命令的正确输出重定向到文件中，如果文件已存在，则覆盖。
- `>>` 用于将命令的正确输出重定向到文件中，如果文件已存在，则追加。

例如，将 `echo` 命令的输出保存到文件中：

```bash
#!/bin/bash

# 标准输出重定向
ls -l > output.txt

# 追加到文件
echo "追加到文件末尾" >> output.txt

# 错误输出重定向
ls not_exists 2>> error.log

# 同时保存输出和错误信息
./your_script.sh > output.txt 2>&1

echo "Hello, World!" > hello.txt  # 创建或覆盖 hello.txt 文件
echo "Another line." >> hello.txt  # 追加内容到 hello.txt 文件
```

#### 标准错误输出重定向

- `2>` 用于将命令的错误输出重定向到文件中，如果文件已存在，则覆盖。
- `2>>` 用于将命令的错误输出重定向到文件中，如果文件已存在，则追加。

#### 正确输出和错误信息同时保存

- `command >file 2>&1` 将标准输出和错误输出都重定向到同一个文件中，覆盖模式。
- `command >>file 2>&1` 同上，追加模式。
- `command >file1 2>file2` 将标准输出和错误输出分别重定向到两个不同的文件中，覆盖模式。

### 输入重定向

输入重定向使我们能够改变命令的输入来源，不再限于键盘输入。这意味着我们可以从文件中读取输入。

#### Bash 支持的输入重定向符号

- `<` 用于将文件内容作为命令的输入。
- `<<END` 从标准输入（键盘）读取数据，直到遇到`END`标记为止，`END`是自定义的终止字符串。

例如，使用 `cat` 命令读取文件内容：

```bash
#!/bin/bash

# 使用自定义的分界符进行输入
cat <<END
这是一个多行文本输入示例。
END

cat < hello.txt  # 使用文件 hello.txt 的内容作为 cat 命令的输入
```

利用输入输出重定向，我们可以实现数据在程序、文件和终端之间灵活流动。掌握这些技巧后，你就可以更加高效地使用 Shell 进行各种任务处理了。

希望本文能帮助你理解和应用 Shell 输入输出重定向的基本概念和技巧。